# 批量查询作者视频汇总使用指南

## 问题修复说明

**原问题**: 批量查询作者视频时，每个作者都会生成一个单独的CSV文件，导致数据分散。

**修复方案**: 已直接修复原有的脚本 `batch-authors-videos.js`，现在会将所有作者的视频数据汇总到一个CSV文件中。**用户无需更改命令，继续使用原来的脚本名即可。**

## 使用方法

### 1. 准备作者列表文件

创建一个包含作者用户名的文本文件，支持两种格式：

**纯文本格式** (推荐):
```
author1
author2
author3
```

**CSV格式**:
```
author1,其他信息
author2,其他信息
author3,其他信息
```

### 2. 运行批量查询脚本

```bash
cd examples
node batch-authors-videos.js <作者文件> <时间范围> <时间单位> [选项]
```

**参数说明:**
- `<作者文件>`: 包含作者用户名的文件路径
- `<时间范围>`: 数字，表示查询多长时间内的视频
- `<时间单位>`: days/weeks/months (天/周/月)
- `[选项]`: 可选参数
  - `--skip-capcut-check`: 跳过CapCut检测（提高速度）

### 3. 使用示例

```bash
# 查询最近7天内的视频（包含CapCut检测）
node batch-authors-videos.js authors.txt 7 days

# 查询最近2周内的视频（跳过CapCut检测）
node batch-authors-videos.js authors.txt 2 weeks --skip-capcut-check

# 查询最近1个月内的视频
node batch-authors-videos.js authors.txt 1 months
```

## 输出结果

### 控制台输出
- 显示处理进度 `[当前/总数]`
- 每个作者的处理结果（成功✓/失败✗）
- 找到的视频数量
- 前3个视频的预览信息
- 最终统计信息

### CSV文件
- 文件名: `batch_authors_videos_summary_YYYY-MM-DD.csv`
- 位置: `examples/output/` 目录下
- 包含所有作者的视频数据，汇总在一个文件中

### CSV文件字段说明
| 字段名 | 说明 |
|--------|------|
| 视频ID | TikTok视频的唯一标识符 |
| 描述 | 视频描述内容 |
| 作者 | 视频作者用户名 |
| 点赞数 | 视频获得的点赞数量 |
| 评论数 | 视频的评论数量 |
| 分享数 | 视频的分享次数 |
| 播放数 | 视频的播放次数 |
| 创建时间 | 视频发布时间 |
| 视频链接 | 视频的完整URL |
| 是否CapCut投稿 | 是否使用CapCut制作（是/否/未知） |
| 来源平台代码 | 视频来源平台的代码 |

## 优势对比

### 修复前 (batch-authors-videos.js)
❌ 每个作者生成单独的CSV文件  
❌ 数据分散，难以统一分析  
❌ 需要手动合并多个文件  

### 修复后 (batch-authors-videos.js)
✅ 所有作者数据汇总到一个CSV文件  
✅ 便于统一分析和处理  
✅ 提供详细的统计信息  
✅ 按作者显示视频数量统计  
✅ 更好的进度显示和错误处理  

## 注意事项

1. **请求频率**: 脚本会自动在请求之间添加延迟，避免被限制
2. **CapCut检测**: 如果不需要CapCut检测，使用 `--skip-capcut-check` 可显著提高速度
3. **中文显示**: CSV文件包含BOM标记，确保中文正确显示
4. **Excel打开**: 使用Excel打开时选择UTF-8编码

## 故障排除

### 常见问题
1. **"无法获取用户信息"**: 检查用户名是否正确，用户是否存在
2. **请求超时**: 网络问题，稍后重试
3. **未找到视频**: 用户在指定时间范围内没有发布视频

### 日志信息
- ✓ 表示成功处理
- ✗ 表示处理失败
- 每个作者的处理结果都会详细显示

## 性能提示

- 使用 `--skip-capcut-check` 可以显著提高处理速度
- 建议一次处理的作者数量不超过50个
- 如果网络不稳定，可以将作者列表分批处理
